<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Семинар 4: Без Makefile'в</title>
</head>
<body>
<div style="white-space: pre-wrap;">
<h4><i>"Знаете ли вы?.."</i></h4>
Я вам забыл сказать, что компилировать простенькие программы можно с помощью команды <tt>make</tt>, но даже без написания какого-либо <tt>Makefile</tt> <i>(в Linux/MinGW)</i>.
<ul>
<li><b>Linux:</b>
<ul>
<li><b>C:</b>
<ul>
<li>Предположим, у вас есть файл с программой <tt>test.c</tt>.
Скомпилировать его можно так:
<tt><b><u>make test</u></b></tt>
<tt>Makefile</tt> не нужен.
Вывод должен быть такой:
<tt>cc test.c -o test</tt>
где <tt>cc</tt> - симлинк на <tt>gcc</tt>.
</li>
<li>Ну а если захотелось скомпилировать с параметрами, то это тоже можно устроить без <tt>Makefile</tt> - передать их компилятору через переменные окружения <tt>CFLAGS</tt> (для компилятора Си), <tt>CXXFLAGS</tt> (компилятору C++), <tt>CPPFLAGS</tt> (им обоим), <tt>LDFLAGS</tt> (линкеру).
Можно, конечно, сделать, как учили в школе,
<tt>export CFLAGS=-O2</tt>
но тогда эти переменные будут "сидеть в вашей консольке" до окончания сеанса терминала (и могут ещё где-нибудь когда-нибудь кому-нибудь помешать), а чтобы они действовали только для одной команды, можно сделать так:
<tt><b><u>CFLAGS="-Wall -Wextra -O2 -g" LDFLAGS=-lm make test</u></b></tt>
<i>(Linux only)</i>
</li></ul></li>
<li>Аналогично для языка <b>C++</b>. Если у вас есть файл <tt>test.cpp</tt>, то:
<tt><b><u>CXXFLAGS="-Wall -Wextra -O2 -g" make test</u></b></tt>
Вывод должен быть:
<tt>g++ -Wall -Wextra -O2 -g test.cpp -o test</tt>
</li></ul></li>
<li>В <b>Windows (MinGW)</b> делаем так:
<ul>
<li><b>C:</b>
<tt><b><i>path=%path%;C:\Qt\Tools\mingw482_32\bin</i>
set CC=gcc
set CFLAGS=-Wall -Wextra -O2 -g
set LDFLAGS=-lm</b></tt> (если нужно)
<tt><b><u>mingw32-make test</u></b></tt>
Вывод должен быть:
<tt>gcc -Wall -Wextra -O2 -g -lm test.c -o test</tt>
</li>
<li>Для <b>C++</b>:
<tt><b><i>path=%path%;C:\Qt\Tools\mingw482_32\bin</i></b></tt>
(переменные <tt>CC</tt> и <tt>CXX</tt> выставлять не нужно)
<tt><b>set CXXFLAGS=-Wall -Wextra -O2 -g
<u>mingw32-make test</u></b></tt>
Вывод:
<tt>g++ -Wall -Wextra -O2 -g test.cpp -o test</tt>
</li></ul></li>
Вся эта магия доступна за счёт т.н. <i>builtin rules</i> (встроенных правил) утилиты <tt>make</tt>. 
</ul>
P.S. Ну, а пользователям M$ Visual C++ я могу только повторить притчу про ёжиков. :-)
</div>
<div id="comments"></div>
<script src="comments.js"></script>
</body>
</html>
