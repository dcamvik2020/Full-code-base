<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Семинар 8: Указатели</title>
</head>
<body>
<div style="white-space: pre-wrap;">
<ul>
<li><b>Указатель</b> - это переменная, содержащая адрес. Адрес другой переменной, адрес массива, структуры или его/её части, адрес выделенного куска памяти, адрес машинной инструкции, библиотеки... просто какой-то левый адрес, даже если по нему нельзя писать или/и читать.
</li>
<li>Указатели применяются для косвенного доступа к переменным или другим данным. Иногда обратиться к переменной по её имени не представляется возможным (в т.ч. из-за ограничения области видимости - например, когда она объявлена в другой функции), в этом случае можно попытаться добраться до неё по адресам, с помощью указателей и адресной арифметики. Или переменная/объект вовсе не имеет имени - когда память под него была выделена динамически. Есть и другие случаи применения указателей: например, строки, списки, деревья, графы в Си построены на указателях. Ну и более специфические случаи.
</li>
<li><b>Размер</b> переменной-указателя равен размеру машинного слова (4 байта в 32-битных системах, 8 байт в 64-битных, 2 байта в 16-битных (если near-указатели)).
</li>
<li><b>Синтаксис:</b>
<tt>	type *name;</tt>
где <tt>type</tt> - имя типа переменной, на которую указывает указатель. Если описывается сразу несколько указателей, то надо перед каждым ставить звёздочку:
<tt>	int *p1, *p2;</tt>
иначе мы опишем один указатель и одну целую переменную (именно поэтому принято пробел ставить перед *, а не после, как было бы логичнее; но компилятору всё равно, хоть вообще без пробелов).
</li>
<li>Указатель можно "настроить" на какую-нибудь переменную с помощью операции взятия адреса "&":
<tt>	int a = 5;
	int *p = &a; <font color="green">// можно и разделить описание и инициализацию:</font> int *p; p = &a;</tt>
и затем с помощью операции разыменования указателя * читать или писать значение из/в переменную a:
<tt>	*p = 6; <font color="green">// теперь a == 6</font>
	a = 7;
	printf(<font color="green">"%d "</font>, *p); <font color="green">// 7</font>
	*p = *p + 3;
	printf(<font color="green">"%d "</font>, *p); <font color="green">// 10</font></tt>
Т.е. "<tt>a</tt>" и "<tt>*p</tt>" отныне синонимы, и где можно использовать одно, можно использовать и другое, в т.ч. в математических операциях, операторах и функциях ввода-вывода, и т.д.
Но указатель можно и "перенастроить" на другую переменную:
<tt>	int b = 21;
	p = &b;
	printf(<font color="green">"%d "</font>, *p); <font color="green">// 21</font></tt>
</li>
<li>Значение указателя определяет начало куска памяти, с которым идёт работа (левую границу ячейки памяти), а тип, который стоит слева от звёздочки - размер этого куска (а следовательно, и правую границу ячейки памяти).
Пусть далее все указатели имеют значение 0x402000 (16-чное число), а по этому адресу хранятся данные:
<tt>	0x402000: F7 E6 D5 C4 B3 A2 91 80</tt>
Обратите внимание, что в архитектурах little-endian, к коим относится Intel'овская x86, байты в памяти располагаются в обратном порядке.
<tt>	int *pi;
	long long *pl;
	char *pc;</tt>
Пусть все эти указатели указывают на байтик со значением F7.
Тогда <tt>*pi</tt> будет равно <tt>0xC4D5E6F7, *pl == 0x8091A2B3C4D5E6F7, *pc == 0xF7</tt>.
</li>
<li><b>Указатель на структуру.</b>
<tt>	Student *p_stud = ...;</tt>
Ничего нового. <!--При инкременте <tt>p_stud</tt> он численно будет прыгать не на 1, не на 4, а на <tt><b>sizeof</b>(Student)</tt> байт.-->
Единственное, что я забыл / не успел сказать на семинаре - это как получать доступ к полям в этом случае.
Вот так я писать <b>НЕ</b> рекомендую:
<tt>	(*p_stud).age = 18; <font color="green">// обратите внимание на скобочки - приоритет операций</font></tt>
потому что уже давно специально для этого изобрели операцию "стрелочка":
<tt>	p_stud-&gt;age = 18;</tt>
Т.е. <tt>p_stud-&gt;age</tt> эквивалентно <tt>(*p_stud).age</tt> .
Другими словами: для получения доступа к полю структуры
"." применяется, когда слева от неё стоит структура, а
"-&gt;" применяется, когда слева от неё стоит УКАЗАТЕЛЬ на структуру.
</li>
</ul>
</div>
<div id="comments"></div>
<script src="comments.js"></script>
</body>
</html>
