<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Семинар 4: Остатки Си и многомодульные программы - Практика</title>
</head>
<body>
<div style="white-space: pre-wrap;">
Ну а теперь переходим к тому, что я подготовил для вас.
<ul>
<li>Во-первых, расквитаемся с остатками Си.
<a href="../C2/shifr.c" target="_blank">shifr</a> - простейшая шифровалка, основанная на побитовой операции XOR, которую нам показал Александр у доски.
</li>
<li><a href="../C2/eratosfen.c" target="_blank">eratosfen</a> - задача на побитовое решето Эратосфена. Немножко отличается от того, что я писал на доске, т.к. тут я изначально инициализирую массив нулями, а не единицами, поэтому и поразрядные операции несколько другие.
</li>
<li>Обещанная <b>мега-задача</b>. Напомню, это задача из вашего задавальника из 2-го задания, самая последняя и самая большая.
<ul>
<li>Если у вас нет задавальника, то в электронном виде её условие можете найти <a href="../Mega.doc" target="_blank">здесь</a>.
</li>
<li>Программа распределения вариантов мега-задачи, кому интересно - <a href="../C2/roulette.c" target="_blank">roulette</a>.
</li>
<li><a href="../C2/mega625.c" target="_blank">mega625</a> - мой вариант мега-задачи на Си. Я его прокомментирую, когда буду разбирать ассемблерный вариант этой задачи в конце семестра. А пока что можете глянуть по диагонали, чтобы потом лишних ошибок не делать. Обратите внимание, что я разбил решение задачи на 4 обязательные функции (<tt><b>check</b>()</tt>, <tt><b>rule1</b>()</tt>, <tt><b>rule2</b>()</tt> и <tt><b>test</b>()</tt>), от вас буду требовать того же самого. Также обратите внимание на то, что в <tt><b>rule2</b>()</tt> я обошёлся без O(n^2), а в некоторых вариантах можно обойтись и без дополнительной памяти, и даже сделать вообще за один цикл, за один проход по строке. Поэтому сначала сделайте вариант на Си, чтобы я одобрил алгоритм, а потом уже портируйте на ассемблер.
</li></ul></li>
<li>Переходим к многомодульным программам.
<ul>
<li><a href="../C2/prog" target="_blank">prog</a> (необязательно) - разберите самостоятельно <a href="../C2/prog/MinGW/prog.c" target="_blank">примерчик</a>, считающий сумму массива, максимальный по модулю элемент, и сортирующий массив. Функции суммы и сортировки вынесены в отдельный <a href="../C2/prog/MinGW/unit.c" target="_blank">модуль</a>. На этом примере удобно посмотреть, во что разворачиваются макросы после препроцессора.
<ul>
<li>Посмотрите, пожалуйста, файлы <a href="../C2/prog/MinGW/preprocessed/prog1.c" target="_blank">prog/*/preprocessed/prog1.c</a> и <a href="../C2/prog/MinGW/preprocessed/unit1.c" target="_blank">unit1.c</a> - результаты работы препроцессора, из которых я выкинул всё ненужное. Попробуйте в макросах <tt>ABS</tt> и <tt>MAX</tt> убрать внешние скобочки в выражениях <tt>((x) &gt; 0 ? (x) : -(x))</tt> и <tt>((a) &gt; (b) ? (a) : (b))</tt> и посмотреть, что получится.
Обратите внимание, что значения <tt>sizeof A</tt>, <tt>sizeof(int)</tt> вычисляет не препроцессор, а компилятор.
</li>
<li>Команды генерации препроцессированных файлов для Visual C++ и GCC я написал соответственно в файлах <a href="../C2/prog/MSVC/build_detailed.bat" target="_blank">prog\MSVC\build_detailed.bat</a> и <a href="../C2/prog/LinuxGCC/build_detailed.sh" target="_blank">prog/LinuxGCC/build_detailed.sh</a> (для <a href="../C2/prog/MinGW/build_detailed.bat" target="_blank">MinGW</a> аналогично). Там же приведены остальные команды для работы каждой фазы компиляции, которые мы рассматривали на занятии.
</li>
<li>Отдельно остановлюсь ещё на примере компиляции проекта для Вижуал Студии из командной строки. Для этого компилятора надо прописывать не только пути к бинарникам в переменной <tt>PATH</tt>, но, к сожалению, ещё и пути к хедерам и библиотекам. Поэтому, чтобы не загромождать скрипты, я вынес всё это дело в отдельные переменные.
Обратите внимание, что их имена <tt>INCLUDE</tt>, <tt>LIB</tt>, <tt>CFLAGS</tt> и <tt>LFLAGS</tt> выбраны не случайно - это стандартные имена, и в примере <a href="../C2/prog/MSVC/Makefiles/Makefile6" target="_blank">Makefile6</a> переменная <tt>CFLAGS</tt> задана, но нигде явно не используется. Но попробуйте её переименовать и запустить - вы увидите, что используется она неявно.
</li>
<li>И, наконец, в папках Makefiles лежат Makefile'ы для этого проекта. Например, для MinGW <a href="../C2/prog/MinGW/Makefiles" target="_blank">здесь</a>, ну и для других компиляторов - в соседних папках. На зачёте будут вопросы на понимание, чем отличаются директивы препроцессора от директив компилятора, макросы от функций и т.д.
</li></ul></li>
<li>!!! <b><a href="../C2/brute0" target="_blank">brute0</a></b> - шаблон-заготовка-заглушка для задачи <b>bruteforce</b>, среда для экспериментов. Структура файлов и каталогов аналогична проекту <a href="../C2/prog" target="_blank">prog</a>.
<ul>
<li><a href="../C2/brute0/bruteforce_header.c" target="_blank">bruteforce_header</a> - код, который цепляется к вашей посылке bruteforce в EJudge (<tt>main()</tt>, <tt>check()</tt>, ввод-вывод, константы).
</li></ul></li>
<li>О том, что такое Makefile и как они пишутся, см. <a href="sem2_04_makefiles.html">следующее отдельное письмо</a>.
</li>
<li>Папка <a href="../C2/libs" target="_blank">libs</a> содержит ряд примеров по сборке и использованию статических и динамических библиотек. Описание всего этого ждите <a href="sem2_04_adv_magic.html">отдельным письмом</a>.
</li>
</ul>
</li>
</ul>
</div>
<div id="comments"></div>
<script src="comments.js"></script>
</body>
</html>
