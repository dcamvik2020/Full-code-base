<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Семинар 8: Структуры</title>
</head>
<body>
<div style="white-space: pre-wrap;">
Пример описания структуры:

<tt><font color="green">//можно описывать как внутри какой-либо функции, так и вне (глобально)</font>
<font color="green">//в этом случае для структуры применяются те же правила области видимости, что и для переменных</font>
<b>struct</b> my_struct {
	char c;
	int i;
}; <font color="green">//точка с запятой обязательна</font></tt>

и использования:
<tt>	<font color="green">//ключевое слово "<b>struct</b>" здесь обязательно для Си и необязательно для C++,</font>
	<font color="green">//поэтому для нас, будем считать, обязательно в целях переносимости кода</font>
	<b>struct</b> my_struct A = {<font color="green">'c'</font>, 10}, B; <font color="green">//можно инициализировать структуры, аналогично массивам</font>
	B = A; <font color="green">//присваивание работает, а сравнение (==, !=) нет</font>
	B.c = <font color="green">'y'</font>; <font color="green">//доступ к полям структуры осуществляется с помощью операции точка "."</font>
	printf(<font color="green">"%c %d\n"</font>, B.c, B.i);
	printf(<font color="green">"%d\n"</font>, <b>sizeof</b> A); <font color="green">//8</font></tt>
Обратите внимание, что поля структуры могут выравниваться по границе слова (т.е. адреса полей могут быть кратны 4, 8 байт...), тогда между полями может быть т.н. <b><i>padding</i></b>,
поэтому <tt><b>sizeof</b>(my_struct) &ge; <b>sizeof</b>(char) + <b>sizeof</b>(int)</tt>.

Можно вместе с описанием типа структуры ещё описывать и переменные - экземпляры типа "структура":

<tt><b>struct</b> my_struct {
	char c;
	int i;
} A, B;</tt>

Либо, если не хотим писать "<tt><b>struct</b></tt>" каждый раз при объявлении переменных в Си, используем уже изученный нами <tt><b>typedef</b></tt>:

<tt><b>typedef</b> <b>struct</b> my_struct {
	char c;
	int i;
} my_struct;</tt>

В стандартных хедерах можно увидеть, что первое имя иногда делают с подчёркиванием или добавляют приставку <tt>tag</tt>:

<tt><b>typedef</b> <b>struct</b> _my_struct {
	char c;
	int i;
} my_struct;</tt>

Но можно и вообще безымянной структуре присвоить имя-синоним (мой любимый вариант):

<tt><b>typedef</b> <b>struct</b> {
	char c;
	int i;
} my_struct;</tt>

Конечно, если у нас всего одна-две переменных типа "структура", то можно и не загоняться, объединяя разные типы в структуру. Смысл это приобретает, когда у нас есть куча таких объектов (массив, список, дерево, граф...), и нам надо с ними что-то сделать. Ну, например, спаяем на коленке маленькую базу данных:

<tt><b>typedef</b> <b>struct</b> {
	int age;
	double height;
	char name[20];
} Student;</tt>

И заведём массив на 100 студентов:

<tt>	Student studs[100];</tt>

Как-то чем-то заполнили этот массив:

<tt>	studs[i].age = 18;
	studs[i].height = 1.76;
	strcpy(studs[i].name, <font color="green">"Andrey"</font>);</tt>

Затем его как-то обработали: например, отсортировали всех студентов по возрасту. Или по росту. Или же по имени в алфавитном порядке. Или ещё по какому-то более сложному правилу. (Как это делать, рекомендую посмотреть потом, после того, как изучим указатели и qsort.)
Ну и в конце вывели результат на печать. Типичная задача на 2-й контрольной работе.
<!--
Полноценный работающий пример <a href="../C1/pointers/structs.c" target="_blank">здесь</a>.-->
</div>
<div id="comments"></div>
<script src="comments.js"></script>
</body>
</html>
