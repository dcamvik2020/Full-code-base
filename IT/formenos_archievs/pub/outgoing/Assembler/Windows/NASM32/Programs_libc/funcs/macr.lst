     1                                  section .text use32 class=CODE
     2                                  
     3                                  ; Начало макроса
     4                                  ; parameters: %1, %2, %3, %4
     5                                  %macro my_macro 4			; 4 - это число параметров в макросе
     6                                  	mov eax, %1			; к параметрам обращаемся по номеру, после %
     7                                  	add eax, %2
     8                                  	add eax, %3
     9                                  	add eax, %4
    10                                  ;	mov %1, %2			; можно не только в правой части, но и в левой
    11                                  %endmacro
    12                                  ; Конец макроса
    13                                  
    14                                  global _start
    15                                  _start:
    16                                  	my_macro 1, 2, 3, 4		; вызов макроса
    16 00000000 B801000000          <1>  mov eax, %1
    16 00000005 83C002              <1>  add eax, %2
    16 00000008 83C003              <1>  add eax, %3
    16 0000000B 83C004              <1>  add eax, %4
    16                              <1> 
    17                                  	; анализ возвращаемого значения
    18 0000000E 83F80A                  	cmp eax, 10
    19 00000011 740E                    	je end
    20                                  
    21                                  ;	my_macro eax, 2, [a], [b]	; можно подавать не только константы, но и регистры и всё что угодно
    22                                  	my_macro 10, 20, 30, 40		; вызов макроса
    22 00000013 B80A000000          <1>  mov eax, %1
    22 00000018 83C014              <1>  add eax, %2
    22 0000001B 83C01E              <1>  add eax, %3
    22 0000001E 83C028              <1>  add eax, %4
    22                              <1> 
    23                                  	; анализ возвращаемого значения
    24                                  ;	cmp eax, 0
    25                                  ;	jcc ...
    26                                  
    27                                  end:
    28 00000021 B800000000              	mov eax, 0
    29 00000026 C3                      	ret
